CKEDITOR.plugins.add("autotag",{requires:"autocomplete,textmatch,codemirror",init:function(editor){editor.on("instanceReady",(function(){var config={};function textTestCallback(range){if(!range.collapsed){return null}return CKEDITOR.plugins.textMatch.match(range,matchCallback)}function matchCallback(text,offset){var left=text.slice(0,offset),match=left.match(/\w*$/);if(!match){return null}return{start:match.index,end:offset}}config.textTestCallback=textTestCallback;var itemsArray=[{id:"div",name:"<div></div>",type:"feature"},{id:"span",name:"<span></span>",type:"feature"}];function dataCallback(matchInfo,callback){var query=matchInfo.query.substring(0);var suggestions=itemsArray.filter((function(item){console.log(item);console.log(query);console.log(String(item.id).indexOf(query));return String(item.id).indexOf(query)==0}));callback(suggestions)}config.dataCallback=dataCallback;config.itemTemplate="{id}: {name}";config.outputTemplate="{name}";new CKEDITOR.plugins.autocomplete(editor,config)}))}});